#include <string.h>

#include <sys/socket.h>

#include <linux/netlink.h>
#include <linux/unix_diag.h>
#include <linux/sock_diag.h>

int main() {
	struct {
		struct nlmsghdr nlh;
		struct unix_diag_req r;
	} req;
	int fd;

	memset(&req, 0, sizeof(req));
	req.nlh.nlmsg_len = sizeof(req);
	req.nlh.nlmsg_type = SOCK_DIAG_BY_FAMILY;
	req.nlh.nlmsg_flags = NLM_F_ROOT|NLM_F_MATCH|NLM_F_REQUEST;
	req.nlh.nlmsg_seq = 123456;

	if ((fd = socket(AF_NETLINK, SOCK_RAW, NETLINK_SOCK_DIAG)) < 0)
		return 1;

	if (send(fd, &req, sizeof(req), 0) < 0)
		return 1;

	return 0;
}

